\begin{table}[!ht]
\setlength\tabcolsep{0pt}
\centering
\begin{threeparttable}
\begin{tabular}{@{\extracolsep{2ex}}*{8}{cccccccc}}
\toprule
\multicolumn{3}{c}{\textbf{Problem}} & \multicolumn{2}{c}{\textbf{Sparsity}} & \multicolumn{3}{c}{\textbf{Pattern detection\tnote{1}}} \\
\cmidrule{1-3}\cmidrule{4-5}\cmidrule{6-8}
N & Inputs & Outputs & Zeros & Colors\tnote{2} & Symbolics & \multicolumn{2}{c}{SCT\tnote{3}} \\
\cmidrule{1-1}\cmidrule{2-2}\cmidrule{3-3}\cmidrule{4-4}\cmidrule{5-5}\cmidrule{6-6}\cmidrule{7-8}
6 & 72 & 72 & 91.67\% & 9 & $3.69 \cdot 10^{-3}$ & $\mathbf{2.13 \cdot 10^{-5}}$ & \textbf{(173.1)} \\
12 & 288 & 288 & 97.92\% & 10 & $1.58 \cdot 10^{-2}$ & $\mathbf{8.85 \cdot 10^{-5}}$ & \textbf{(178.7)} \\
24 & 1152 & 1152 & 99.48\% & 10 & $6.40 \cdot 10^{-2}$ & $\mathbf{3.98 \cdot 10^{-4}}$ & \textbf{(160.6)} \\
48 & 4608 & 4608 & 99.87\% & 10 & $2.71 \cdot 10^{-1}$ & $\mathbf{2.20 \cdot 10^{-3}}$ & \textbf{(123.2)} \\
96 & 18432 & 18432 & 99.97\% & 10 & $1.13 \cdot 10^{0}$ & $\mathbf{1.87 \cdot 10^{-2}}$ & \textbf{(60.5)} \\
192 & 73728 & 73728 & 99.99\% & 10 & $4.78 \cdot 10^{0}$ & $\mathbf{2.05 \cdot 10^{-1}}$ & \textbf{(23.3)} \\
\bottomrule
\end{tabular}
\begin{tablenotes}[flushleft]
\footnotesize
\item[1]Wall time in seconds.
\item[2]Number of colors resulting from greedy column coloring.
\item[3]In parentheses: Wall time ratio compared to Symbolics.jl's pattern detection (higher is better).
\end{tablenotes}
\end{threeparttable}
\caption{Performance comparison of Jacobian sparsity pattern detection on the Brusselator PDE.}
\label{tab:brusselator_detection}
\end{table}

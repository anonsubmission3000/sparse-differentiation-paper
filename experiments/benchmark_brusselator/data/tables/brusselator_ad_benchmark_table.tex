\begin{table}[!ht]
\setlength\tabcolsep{0pt}
\centering
\begin{threeparttable}
\begin{tabular}{@{\extracolsep{2ex}}*{9}{ccccccccc}}
\toprule
\textbf{Problem} & \multicolumn{5}{c}{\textbf{Jacobian computation\tnote{1}}} & \multicolumn{3}{c}{\textbf{Newton step\tnote{1}}} \\
\cmidrule{1-1}\cmidrule{2-6}\cmidrule{7-9}
N & $\makecell{\text{AD} \\ \text{(prepared)}}$ & \multicolumn{2}{c}{$\makecell{\text{ASD} \\ \text{(prepared)}}$\tnote{2}} & \multicolumn{2}{c}{$\makecell{\text{ASD} \\ \text{(unprepared)}}$\tnote{2}} & $\makecell{\text{JVP} \\ \text{(iterative)}}$ & $\makecell{\text{Jacobian} \\ \text{(iterative)}}$ & $\makecell{\text{Jacobian} \\ \text{(direct)}}$ \\
\cmidrule{1-1}\cmidrule{2-2}\cmidrule{3-4}\cmidrule{5-6}\cmidrule{7-7}\cmidrule{8-8}\cmidrule{9-9}
6 & $1.64 \cdot 10^{-5}$ & $\mathbf{1.97 \cdot 10^{-6}}$ & \textbf{(8.3)} & $3.36 \cdot 10^{-5}$ & (0.5) & $\mathbf{2.07 \cdot 10^{-5}}$ & $2.19 \cdot 10^{-5}$ & $4.52 \cdot 10^{-5}$ \\
12 & $2.44 \cdot 10^{-4}$ & $\mathbf{8.67 \cdot 10^{-6}}$ & \textbf{(28.1)} & $1.70 \cdot 10^{-4}$ & (1.4) & $\mathbf{1.34 \cdot 10^{-4}}$ & $1.61 \cdot 10^{-4}$ & $2.42 \cdot 10^{-4}$ \\
24 & $4.02 \cdot 10^{-3}$ & $\mathbf{3.43 \cdot 10^{-5}}$ & \textbf{(117.2)} & $1.31 \cdot 10^{-3}$ & (3.1) & $\mathbf{1.04 \cdot 10^{-3}}$ & $1.34 \cdot 10^{-3}$ & $1.24 \cdot 10^{-3}$ \\
48 & $7.60 \cdot 10^{-2}$ & $\mathbf{1.68 \cdot 10^{-4}}$ & \textbf{(451.4)} & $1.70 \cdot 10^{-2}$ & (4.5) & $\mathbf{8.34 \cdot 10^{-3}}$ & $1.17 \cdot 10^{-2}$ & $8.98 \cdot 10^{-3}$ \\
96 & $1.35 \cdot 10^{0}$ & $\mathbf{6.68 \cdot 10^{-4}}$ & \textbf{(2017.2)} & $2.16 \cdot 10^{-1}$ & (6.2) & $7.56 \cdot 10^{-2}$ & $1.11 \cdot 10^{-1}$ & $\mathbf{4.07 \cdot 10^{-2}}$ \\
192 & $2.25 \cdot 10^{1}$ & $\mathbf{3.09 \cdot 10^{-3}}$ & \textbf{(7293.5)} & $4.62 \cdot 10^{0}$ & (4.9) & $1.05 \cdot 10^{0}$ & $1.07 \cdot 10^{0}$ & $\mathbf{2.30 \cdot 10^{-1}}$ \\
\bottomrule
\end{tabular}
\begin{tablenotes}[flushleft]
\footnotesize
\item[1]Wall time in seconds.
\item[2]In parentheses: Wall time ratio compared to prepared AD (higher is better).
\end{tablenotes}
\end{threeparttable}
\caption{Performance comparison of Jacobian computation \& linear solves on the Brusselator PDE.}
\label{tab:brusselator_ad}
\end{table}
